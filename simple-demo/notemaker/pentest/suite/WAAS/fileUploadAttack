echo
echo   "---------------   FILE UPLOAD ATTACK --------------------"

websvc=$(getNginxURL)
[[ $? -ne 0 ]] && echo $websvc && exit $?

echo   "------ uploading attack.sh to http://$websvc   ---"
curl -s -F 'data=@attack.sh' $websvc/note > responses/fileUpResponse.html
success=$(grep -c 'App Firewall rule' responses/fileUpResponse.html)

if [ "$success" == "0" ]; then
  echo "   >> FILE UPLOAD attack succeeded"
  echo "!------------- FILE UPLOAD ATTACK SUCCEEDED -------------"
else
  echo "   >> FILE UPLOAD attack prevented"
  echo "----- open responses/fileUpResponse.html to vew resp ----"
  echo "------------- FILE UPLOAD ATTACK FAILED  ----------------"
fi
echo

