#!/bin/bash
echo
echo "-----------   CROSS SITE SCRIPTING ATTACK ---------------"

websvc=$(getNginxURL)
[[ $? -ne 0 ]] && echo $websvc && exit $?

echo "------ launching CSS attack on http://$websvc "

curl -s -o responses/css-response.html -d "<script>alert(1)</script>" http://$websvc
success=$(grep -c POST responses/css-response.html)

if [ "$success" == "1" ]; then
  echo "   >> CSS attack succeeded"
  echo "!-------- CROSS SITE SCRIPTING ATTACK SUCCESSFUL --------"
else
  echo "   >> CSS attack prevented"
  echo "---- open css-response.html in browser to see result ----"
  echo "--------- CROSS SITE SCRIPTING ATTACK FAILED ------------"
fi
echo



