#!/bin/bash
  
websvc=$(getNginxURL)
[[ $? -ne 0 ]] && echo $websvc && exit $?

echo "------------   LOCAL FILE INCLUSION ATTACK ---------------"
echo "-- launching local file inclusion attack on http://$websvc"

curl -s -o responses/localfile-response.html "http://$websvc?page=../../../../../../etc/passwd"
success=$(grep -c "Request violates WAAS Firewall rule" responses/localfile-response.html)
if [ "$success" == "0" ]; then
  echo "   >> local file inclusion attack succeeded"
  echo "!-------  LOCAL FILE INCLUSION ATTACK SUCCESSFUL ----------"
else
  echo "   >> local file inclusion attack prevented"
  echo "---------   LOCAL FILE INCLUSION ATTACK FAILED   ----------"
fi
echo


